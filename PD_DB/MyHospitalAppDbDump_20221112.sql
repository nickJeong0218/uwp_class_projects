CREATE TABLE `AFFILIATED_WITH` (
  `Physician` int NOT NULL,
  `Department` int NOT NULL,
  `PrimaryAffiliation` int NOT NULL,
  PRIMARY KEY (`Physician`,`Department`),
  KEY `AFFILIATED_WITH___fk2` (`Department`),
  CONSTRAINT `AFFILIATED_WITH___fk1` FOREIGN KEY (`Physician`) REFERENCES `PHYSICIANS` (`EmployeeID`) ON DELETE CASCADE,
  CONSTRAINT `AFFILIATED_WITH___fk2` FOREIGN KEY (`Department`) REFERENCES `DEPARTMENTS` (`DepartmentID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `AFFILIATED_WITH` VALUES (10844,3,1),(12582,1,0),(12582,2,1),(14043,1,1),(15640,1,1),(15977,3,1),(16160,2,1),(17382,1,1),(19161,1,0),(19161,2,1),(19702,1,1),(19957,1,1);
CREATE TABLE `APPOINTMENTS` (
  `AppointmentID` int NOT NULL,
  `Patient` int NOT NULL,
  `PrepNurse` int NOT NULL,
  `Physician` int NOT NULL,
  `StartDateTime` datetime NOT NULL,
  `EndDateTime` datetime NOT NULL,
  `ExaminationRoom` char(1) NOT NULL,
  PRIMARY KEY (`AppointmentID`),
  UNIQUE KEY `AppointmentAK1` (`Patient`,`PrepNurse`,`Physician`),
  KEY `APPOINTMENTS___fk2` (`PrepNurse`),
  KEY `APPOINTMENTS___fk3` (`Physician`),
  CONSTRAINT `APPOINTMENTS___fk1` FOREIGN KEY (`Patient`) REFERENCES `PATIENTS` (`PatientID`),
  CONSTRAINT `APPOINTMENTS___fk2` FOREIGN KEY (`PrepNurse`) REFERENCES `NURSES` (`EmployeeID`),
  CONSTRAINT `APPOINTMENTS___fk3` FOREIGN KEY (`Physician`) REFERENCES `PHYSICIANS` (`EmployeeID`),
  CONSTRAINT `APPOINTMENTS_chk_1` CHECK ((`StartDateTime` < `EndDateTime`)),
  CONSTRAINT `APPOINTMENTS_chk_2` CHECK ((`ExaminationRoom` in (_utf8mb4'A',_utf8mb4'B',_utf8mb4'C',_utf8mb4'D')))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `APPOINTMENTS` VALUES (40303,22369,32426,19702,'2021-08-24 10:00:00','2021-08-24 11:00:00','A'),(40975,29634,37225,19702,'2021-08-24 09:00:00','2021-08-24 10:00:00','B'),(41477,21131,32064,16160,'2021-08-26 13:00:00','2021-08-26 14:00:00','D'),(41945,21936,32339,19957,'2021-08-26 11:00:00','2021-08-26 12:00:00','D'),(42062,26798,32247,12582,'2021-08-26 09:00:00','2021-08-26 10:00:00','D'),(43181,29634,34631,17382,'2021-08-24 10:00:00','2021-08-24 11:00:00','C'),(43187,29292,35704,15640,'2021-08-24 12:00:00','2021-08-24 13:00:00','C'),(43329,22369,32426,17382,'2021-08-24 09:00:00','2021-08-24 10:00:00','A'),(43930,27959,32247,12582,'2021-08-26 10:00:00','2021-08-26 11:00:00','D'),(44150,27959,34631,15977,'2021-08-26 09:00:00','2021-08-26 10:00:00','C'),(44182,21131,32362,10844,'2021-08-26 14:00:00','2021-08-26 15:00:00','C'),(44872,28446,37019,16160,'2021-08-27 12:00:00','2021-08-27 13:00:00','A'),(45935,28446,37019,14043,'2021-08-27 11:00:00','2021-08-27 12:00:00','A'),(46379,29292,35704,19161,'2021-08-24 11:00:00','2021-08-24 12:00:00','C'),(46523,21936,32339,14043,'2021-08-26 12:00:00','2021-08-26 13:00:00','D'),(46671,21131,36285,19161,'2021-08-26 12:00:00','2021-08-26 13:00:00','B'),(47242,22369,37225,15640,'2021-08-24 11:00:00','2021-08-24 12:00:00','B'),(48700,20895,32362,10844,'2021-08-25 13:00:00','2021-08-25 14:00:00','A'),(49585,20895,32064,15977,'2021-08-25 15:00:00','2021-08-25 16:00:00','C'),(49656,20895,36285,19957,'2021-08-25 14:00:00','2021-08-25 15:00:00','B');
CREATE TABLE `BLOCKS` (
  `BlockFloor` int NOT NULL,
  `BlockCode` int NOT NULL,
  PRIMARY KEY (`BlockFloor`,`BlockCode`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `BLOCKS` VALUES (1,1),(1,2),(1,3),(2,1),(2,2),(2,3),(3,1),(3,2),(3,3),(4,1),(4,2),(4,3);
CREATE TABLE `DEPARTMENTS` (
  `DepartmentID` int NOT NULL,
  `Name` varchar(40) NOT NULL,
  `Head` int NOT NULL,
  PRIMARY KEY (`DepartmentID`),
  UNIQUE KEY `DEPARTMENTSAK1` (`Name`),
  UNIQUE KEY `DEPARTEMNTSAK2` (`Head`),
  CONSTRAINT `DEPARTMENTS___fk` FOREIGN KEY (`Head`) REFERENCES `PHYSICIANS` (`EmployeeID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `DEPARTMENTS` VALUES (1,'General Medicine',15640),(2,'Surgery',19161),(3,'Psychiatry',10844);
CREATE TABLE `MEDICATIONS` (
  `Code` int NOT NULL,
  `Name` varchar(30) NOT NULL,
  `Brand` varchar(75) NOT NULL,
  `Description` varchar(200) DEFAULT 'N/A',
  PRIMARY KEY (`Code`),
  UNIQUE KEY `MEDICATIONS_AK` (`Name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `MEDICATIONS` VALUES (50542,'Ectitigon','Bristol-Myers Squibb Company','N/A'),(55695,'Tripolyaka','Biogen','N/A'),(57587,'Visnet','Pfizer Inc.','N/A'),(57933,'Alefloxen','Abbott Laboratories','N/A'),(59081,'Nivinvia','Merck','N/A');
CREATE TABLE `NURSES` (
  `EmployeeID` int NOT NULL,
  `Position` char(10) NOT NULL,
  `Registered` tinyint(1) NOT NULL,
  `Person` int NOT NULL,
  PRIMARY KEY (`EmployeeID`),
  UNIQUE KEY `NURSES_AK` (`Person`),
  CONSTRAINT `NURSES___fk` FOREIGN KEY (`Person`) REFERENCES `PERSONS` (`SSN`),
  CONSTRAINT `position_check` CHECK ((`Position` in (_utf8mb4'Nurse',_utf8mb4'Head Nurse')))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `NURSES` VALUES (32064,'Nurse',1,397827047),(32247,'Nurse',1,388823527),(32339,'Nurse',0,387226717),(32362,'Nurse',1,398403692),(32426,'Head Nurse',1,388223007),(34631,'Nurse',1,397542428),(35704,'Head Nurse',1,391040685),(36285,'Nurse',1,396806263),(37019,'Nurse',1,392338525),(37225,'Nurse',0,387366550);
CREATE TABLE `ON_CALL` (
  `Nurse` int NOT NULL,
  `BlockFloor` int NOT NULL,
  `BlockCode` int NOT NULL,
  `OnCallStart` datetime NOT NULL,
  `OnCallEnd` datetime NOT NULL,
  PRIMARY KEY (`Nurse`,`BlockFloor`,`BlockCode`,`OnCallStart`,`OnCallEnd`),
  KEY `ON_CALL___fk2` (`BlockFloor`,`BlockCode`),
  CONSTRAINT `ON_CALL___fk1` FOREIGN KEY (`Nurse`) REFERENCES `NURSES` (`EmployeeID`),
  CONSTRAINT `ON_CALL___fk2` FOREIGN KEY (`BlockFloor`, `BlockCode`) REFERENCES `BLOCKS` (`BlockFloor`, `BlockCode`),
  CONSTRAINT `check_time` CHECK ((`OnCallStart` < `OnCallEnd`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `ON_CALL` VALUES (32064,1,1,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32247,1,1,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(32339,1,1,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32339,1,1,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32362,1,1,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32426,1,1,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(34631,1,1,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(37019,1,1,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32064,1,2,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32247,1,2,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(32339,1,2,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32339,1,2,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32362,1,2,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32426,1,2,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(34631,1,2,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(37019,1,2,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32064,1,3,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32247,1,3,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(32339,1,3,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32339,1,3,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32362,1,3,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32426,1,3,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(34631,1,3,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(37019,1,3,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32064,2,1,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32247,2,1,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32339,2,1,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32426,2,1,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(35704,2,1,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(36285,2,1,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(37019,2,1,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37225,2,1,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32064,2,2,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32247,2,2,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32339,2,2,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32426,2,2,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(35704,2,2,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(36285,2,2,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(37019,2,2,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37225,2,2,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32064,2,3,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32247,2,3,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(32339,2,3,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32426,2,3,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(35704,2,3,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(36285,2,3,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(37019,2,3,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37225,2,3,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32247,3,1,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32339,3,1,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32362,3,1,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32426,3,1,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(34631,3,1,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(36285,3,1,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37019,3,1,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37225,3,1,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32247,3,2,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32339,3,2,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32362,3,2,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32426,3,2,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(34631,3,2,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(36285,3,2,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37019,3,2,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37225,3,2,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32247,3,3,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(32339,3,3,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(32362,3,3,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(32426,3,3,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(34631,3,3,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(36285,3,3,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(37019,3,3,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37225,3,3,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32064,4,1,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32362,4,1,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32426,4,1,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(34631,4,1,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(35704,4,1,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(36285,4,1,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37019,4,1,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(37225,4,1,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32064,4,2,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32362,4,2,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32426,4,2,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(34631,4,2,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(35704,4,2,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(36285,4,2,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37019,4,2,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(37225,4,2,'2021-08-26 07:00:00','2021-08-26 19:00:00'),(32064,4,3,'2021-08-24 19:00:00','2021-08-25 07:00:00'),(32362,4,3,'2021-08-25 19:00:00','2021-08-26 07:00:00'),(32426,4,3,'2021-08-27 19:00:00','2021-08-28 07:00:00'),(34631,4,3,'2021-08-25 07:00:00','2021-08-25 19:00:00'),(35704,4,3,'2021-08-24 07:00:00','2021-08-24 19:00:00'),(36285,4,3,'2021-08-26 19:00:00','2021-08-27 07:00:00'),(37019,4,3,'2021-08-27 07:00:00','2021-08-27 19:00:00'),(37225,4,3,'2021-08-26 07:00:00','2021-08-26 19:00:00');
CREATE TABLE `PATIENTS` (
  `PatientID` int NOT NULL,
  `InsuranceID` int NOT NULL,
  `PCP` int NOT NULL,
  `Person` int NOT NULL,
  PRIMARY KEY (`PatientID`),
  UNIQUE KEY `PATIENTS_AK` (`Person`),
  CONSTRAINT `PATIENTS___fk` FOREIGN KEY (`Person`) REFERENCES `PERSONS` (`SSN`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `PATIENTS` VALUES (20895,5550256,10007310,469603236),(21131,5550512,10009396,389237442),(21936,5551204,10006260,354864616),(22369,5550256,10008036,389343379),(26798,5552048,10002762,391097803),(27959,5550512,10004289,396331535),(28446,5550256,10008747,397964007),(29292,5552048,10008832,357867164),(29634,5551204,10003013,397503170);
CREATE TABLE `PERSONS` (
  `SSN` int NOT NULL,
  `FirstName` varchar(30) NOT NULL,
  `LastName` varchar(30) NOT NULL,
  `Address1` varchar(75) NOT NULL,
  `Address2` varchar(75) DEFAULT NULL,
  `City` varchar(25) NOT NULL,
  `State` char(2) NOT NULL,
  `ZipCode` int NOT NULL,
  `Phone` char(14) NOT NULL,
  PRIMARY KEY (`SSN`),
  UNIQUE KEY `PERSONS_AK1` (`Phone`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `PERSONS` VALUES (354864616,'James','Richardson','1111 W Touhy Ave',NULL,'Des Plaines','IL',60018,'(770) 984-3262'),(357867164,'Alan','Thomas','1750 Palm Dr','#43','Mount Prospect','IL',60056,'(757) 898-5408'),(387226717,'Walter','Johnson','8680 Westlake Dr',NULL,'Greendale','WI',53129,'(920) 206-1473'),(387366550,'Jean','Mitchell','53-W16721 Whitetail Run',NULL,'Menomonee Falls','WI',53051,'(262) 783-1686'),(387404355,'Maurice','Zimmerman','905 Station St',NULL,'Watertown','WI',53094,'(920) 206-0540'),(388223007,'Denise','Kelly','53-W14300 Aberdeen Dr',NULL,'Menomonee Falls','WI',53051,'(262) 783-4935'),(388353360,'Alexandra','May','11588 Saint Croix Trl',NULL,'Solon Springs','WI',54873,'(715) 378-2303'),(388823527,'Stephen','Harris','530 E Cook St',NULL,'Portage','WI',53901,'(608) 566-1279'),(389237442,'Justin','Phillips','116 N Division St',NULL,'Waupaca','WI',54981,'(715) 942-2379'),(389343379,'Daniel','Martin','116 3rd Ave S',NULL,'Strum','WI',54770,'(715) 695-3571'),(389486599,'Craig','Simmons','1159 Central Ave',NULL,'Beloit','WI',53511,'(608) 362-3031'),(389522985,'Emanuel','Richardson','8675 Rolling Hills Rd',NULL,'Custer','WI',54423,'(903) 643-3636'),(391040685,'Martha','Lee','530 49th Ave',NULL,'Kenosha','WI',53144,'(262) 552-8051'),(391097803,'Cynthia','Green','116 E Division Ave',NULL,'Barron','WI',54812,'(715) 637-3601'),(392338525,'Todd','Taylor','53-W15891 Creekwood Xing',NULL,'Menomonee Falls','WI',53051,'(262) 790-9615'),(394156248,'Della','Austin','201 S Water St',NULL,'Watertown','WI',53094,'(920) 206-0193'),(394602564,'Carla','Neal','1075 Hc 2','#BX 1075','Florence','WI',54121,'(906) 776-9965'),(395255681,'Freda','Logan','6604 Parkview Dr',NULL,'Greenville','WI',54942,'(920) 202-3488'),(395486872,'Ronald','Ingram','600 Maple Crest Ln',NULL,'Watertown','WI',53094,'(920) 206-0288'),(396331535,'Ashley','Gonzales','116 3rd St',NULL,'Dane','WI',53529,'(608) 850-6585'),(396806263,'Bonnie','Jones','53-W33422 Terrace Dr',NULL,'Nashotah','WI',53058,'(262) 367-8998'),(397503170,'Deborah','Cooper','116 E Burns St',NULL,'Portage','WI',53901,'(608) 742-4665'),(397542428,'Terry','McCray','53-W37191 Wilson St',NULL,'Oconomowoc','WI',53066,'(262) 569-0922'),(397827047,'Fred','James','870 County Pp Rd',NULL,'Elmwood','WI',54740,'(715) 639-2032'),(397964007,'Irene','Hughes','116 E Schneider St',NULL,'Rice Lake','WI',54868,'(715) 736-0573'),(398095321,'Connie','Gross','490 E Grand Ave','Apt. 1B','Wisconsin Rapids','WI',54494,'(903) 834-6318'),(398403692,'Jacqueline','Brown','53-W34461 Q Rd',NULL,'Okauchee','WI',53069,'(262) 569-7182'),(398706975,'Courtney','White','2002 S Grand Ave',NULL,'Waukesha','WI',53189,'(901) 743-4602'),(469603236,'Rose','Hall','928 Chicago Ave S','#31','Minneapolis','MN',55404,'(612) 333-6457');
CREATE TABLE `PHYSICIANS` (
  `EmployeeID` int NOT NULL,
  `Position` varchar(30) NOT NULL,
  `Person` int NOT NULL,
  PRIMARY KEY (`EmployeeID`),
  UNIQUE KEY `PHISICIANS_AK` (`Person`),
  CONSTRAINT `PHYSICIANS___fk` FOREIGN KEY (`Person`) REFERENCES `PERSONS` (`SSN`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `PHYSICIANS` VALUES (10844,'Attending Psychiatrist',388353360),(12582,'Surgical Attending Physician',398095321),(14043,'Head Chief of Medicine',395255681),(15640,'Senior Attending Physician',394602564),(15977,'Attending Psychiatrist',389486599),(16160,'Surgical Attending Physician',394156248),(17382,'Staff Internist',398706975),(19161,'Surgical Attending Physician',395486872),(19702,'Attending Physician',389522985),(19957,'MD Resident',387404355);
CREATE TABLE `PRESCRIBES` (
  `Physician` int NOT NULL,
  `Patient` int NOT NULL,
  `Medication` int NOT NULL,
  `PrescribedDateTime` datetime NOT NULL,
  `Appointment` int NOT NULL,
  `Dose` int NOT NULL,
  PRIMARY KEY (`Medication`,`Appointment`),
  KEY `PRESCRIBES___fk1` (`Physician`),
  KEY `PRESCRIBES___fk2` (`Patient`),
  KEY `PRESCRIBES___fk4` (`Appointment`),
  CONSTRAINT `PRESCRIBES___fk1` FOREIGN KEY (`Physician`) REFERENCES `PHYSICIANS` (`EmployeeID`),
  CONSTRAINT `PRESCRIBES___fk2` FOREIGN KEY (`Patient`) REFERENCES `PATIENTS` (`PatientID`),
  CONSTRAINT `PRESCRIBES___fk3` FOREIGN KEY (`Medication`) REFERENCES `MEDICATIONS` (`Code`) ON DELETE CASCADE,
  CONSTRAINT `PRESCRIBES___fk4` FOREIGN KEY (`Appointment`) REFERENCES `APPOINTMENTS` (`AppointmentID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `PRESCRIBES` VALUES (15640,29292,50542,'2021-08-24 13:28:00',43187,10),(15977,20895,50542,'2021-08-25 16:16:00',49585,7),(12582,26798,55695,'2021-08-26 10:00:00',42062,12),(16160,28446,55695,'2021-08-27 13:34:00',44872,10),(12582,27959,57587,'2021-08-26 11:00:00',43930,5),(15640,22369,57587,'2021-08-24 10:27:00',47242,5),(17382,29634,57933,'2021-08-24 11:44:00',43181,25),(14043,21936,57933,'2021-08-26 13:00:00',46523,25),(10844,21131,59081,'2021-08-26 15:18:00',44182,10);
CREATE TABLE `PROCEDURES` (
  `Code` int NOT NULL,
  `Name` varchar(50) NOT NULL,
  `Cost` int NOT NULL,
  PRIMARY KEY (`Code`),
  UNIQUE KEY `PROCEDURES_AK` (`Name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `PROCEDURES` VALUES (1001,'CT Scan',1500),(1002,'Hernia Surgery',3750),(1003,'Appendectomy',4500),(1004,'Heart Bypass Surgery',10000),(1005,'Angioplasty & Stent Placement',4899),(1006,'Aortic Valve Replacements',5600),(1007,'MRI',1125);
CREATE TABLE `ROOMS` (
  `RoomNumber` int NOT NULL,
  `RoomType` varchar(25) NOT NULL,
  `BlockFloor` int NOT NULL,
  `BlockCode` int NOT NULL,
  `Unavailable` tinyint(1) NOT NULL,
  PRIMARY KEY (`RoomNumber`),
  KEY `ROOMS__pk` (`BlockFloor`,`BlockCode`),
  CONSTRAINT `ROOMS__pk` FOREIGN KEY (`BlockFloor`, `BlockCode`) REFERENCES `BLOCKS` (`BlockFloor`, `BlockCode`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `ROOMS` VALUES (101,'Single',1,1,0),(102,'Single',1,1,0),(103,'Single',1,1,0),(111,'Single',1,2,0),(112,'Single',1,2,1),(113,'Single',1,2,0),(121,'Single',1,3,0),(122,'Single',1,3,0),(123,'Single',1,3,0),(201,'Single',2,1,1),(202,'Single',2,1,0),(203,'Single',2,1,0),(211,'Single',2,2,0),(212,'Single',2,2,0),(213,'Single',2,2,1),(221,'Single',2,3,0),(222,'Single',2,3,0),(223,'Single',2,3,0),(301,'Single',3,1,0),(302,'Single',3,1,1),(303,'Single',3,1,0),(311,'Single',3,2,0),(312,'Single',3,2,0),(313,'Single',3,2,0),(321,'Single',3,3,1),(322,'Single',3,3,0),(323,'Single',3,3,0),(401,'Single',4,1,0),(402,'Single',4,1,1),(403,'Single',4,1,0),(411,'Single',4,2,0),(412,'Single',4,2,0),(413,'Single',4,2,0),(421,'Single',4,3,1),(422,'Single',4,3,0),(423,'Single',4,3,0);
CREATE TABLE `STAYS` (
  `StayID` int NOT NULL,
  `Patient` int NOT NULL,
  `Room` int NOT NULL,
  `StayStart` datetime NOT NULL,
  `StayEnd` datetime NOT NULL,
  PRIMARY KEY (`StayID`),
  UNIQUE KEY `STAYS_AK` (`Patient`,`StayStart`,`StayEnd`),
  KEY `STAYS___fk2` (`Room`),
  CONSTRAINT `STAYS___fk1` FOREIGN KEY (`Patient`) REFERENCES `PATIENTS` (`PatientID`),
  CONSTRAINT `STAYS___fk2` FOREIGN KEY (`Room`) REFERENCES `ROOMS` (`RoomNumber`),
  CONSTRAINT `check_stayTime` CHECK ((`StayStart` <= `StayEnd`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `STAYS` VALUES (62715,28446,111,'2021-09-03 00:00:00','2021-09-08 00:00:00'),(62716,29292,123,'2021-08-27 00:00:00','2021-08-29 00:00:00'),(62717,21936,112,'2021-09-01 00:00:00','2021-09-02 00:00:00'),(62718,26798,101,'2021-08-27 00:00:00','2021-08-27 00:00:00'),(62719,27959,102,'2021-08-28 00:00:00','2021-08-28 00:00:00');
CREATE TABLE `TRAINED_IN` (
  `Physician` int NOT NULL,
  `Treatment` int NOT NULL,
  `CertificationDate` datetime NOT NULL,
  `CertificationExpires` datetime NOT NULL,
  PRIMARY KEY (`Physician`,`Treatment`),
  KEY `TRAINED_IN___fk2` (`Treatment`),
  CONSTRAINT `TRAINED_IN___fk1` FOREIGN KEY (`Physician`) REFERENCES `PHYSICIANS` (`EmployeeID`) ON DELETE CASCADE,
  CONSTRAINT `TRAINED_IN___fk2` FOREIGN KEY (`Treatment`) REFERENCES `PROCEDURES` (`Code`) ON DELETE CASCADE,
  CONSTRAINT `check_certification` CHECK ((`CertificationDate` < `CertificationExpires`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `TRAINED_IN` VALUES (12582,1002,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(12582,1003,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(16160,1004,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(16160,1005,'2007-01-01 00:00:00','2007-12-31 00:00:00'),(16160,1006,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(19161,1004,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(19161,1005,'2008-01-01 00:00:00','2008-12-31 00:00:00'),(19161,1006,'2008-01-01 00:00:00','2008-12-31 00:00:00');
CREATE TABLE `UNDERGOES` (
  `Patient` int NOT NULL,
  `Procedures` int NOT NULL,
  `Stay` int NOT NULL,
  `DateUndergoes` datetime NOT NULL,
  `Physician` int NOT NULL,
  `AssistingNurse` int NOT NULL,
  PRIMARY KEY (`Patient`,`Procedures`,`DateUndergoes`),
  KEY `UNDERGOES___fk3` (`Stay`),
  KEY `UNDERGOES___fk4` (`Physician`),
  KEY `UNDERGOES___fk5` (`AssistingNurse`),
  KEY `UNDERGOES___fk2` (`Procedures`),
  CONSTRAINT `UNDERGOES___fk1` FOREIGN KEY (`Patient`) REFERENCES `PATIENTS` (`PatientID`),
  CONSTRAINT `UNDERGOES___fk2` FOREIGN KEY (`Procedures`) REFERENCES `PROCEDURES` (`Code`),
  CONSTRAINT `UNDERGOES___fk3` FOREIGN KEY (`Stay`) REFERENCES `STAYS` (`StayID`),
  CONSTRAINT `UNDERGOES___fk4` FOREIGN KEY (`Physician`) REFERENCES `PHYSICIANS` (`EmployeeID`),
  CONSTRAINT `UNDERGOES___fk5` FOREIGN KEY (`AssistingNurse`) REFERENCES `NURSES` (`EmployeeID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `UNDERGOES` VALUES (21936,1003,62717,'2021-09-01 00:00:00',19161,32064),(26798,1001,62718,'2021-08-27 00:00:00',17382,37019),(27959,1007,62719,'2021-08-28 00:00:00',19161,32339),(28446,1004,62715,'2021-09-03 00:00:00',12582,32362),(29292,1002,62716,'2021-08-27 00:00:00',16160,37225);


